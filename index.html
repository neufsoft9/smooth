<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriAmigo Maka - Tu Asesor Personal de Suplementos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
        }
        .chat-container {
            height: calc(100vh - 180px);
            scroll-behavior: smooth;
        }
        .bot-message {
            animation: fadeIn 0.3s ease-in-out;
        }
        .user-message {
            animation: slideIn 0.3s ease-in-out;
        }
        .product-card {
            transition: all 0.3s ease;
        }
        .product-card:hover {
            transform: translateY(-5px);
        }
        .cta-button {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            transform: translateY(-2px);
        }
        .floating-cart {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #6b7280;
            margin: 0 2px;
        }
        .category-chip {
            transition: all 0.2s ease;
        }
        .category-chip:hover {
            transform: scale(1.05);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        .bounce {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        @keyframes heartbeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Floating Cart Button -->
    <div class="fixed bottom-20 right-4 z-50">
        <a href="https://www.tiendasmaka.com/carrito/" target="_blank" 
           class="floating-cart bg-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center text-blue-600 hover:text-blue-700 transition-all">
            <i class="fas fa-shopping-cart text-2xl"></i>
            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">0</span>
        </a>
    </div>

    <div class="container mx-auto max-w-md h-screen flex flex-col">
        <!-- Enhanced Header with Friendly Tone -->
        <header class="bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4 rounded-b-xl shadow-lg relative">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mr-3 heartbeat">
                        <i class="fas fa-heart text-pink-500 text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">NutriAmigo Maka</h1>
                        <p class="text-xs opacity-90">Tu asesor personal de suplementos</p>
                    </div>
                </div>
                <div class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-xs flex items-center">
                    <i class="fas fa-magic text-yellow-300 mr-1"></i>
                    <span>¡Te ayudo!</span>
                </div>
            </div>
            
            <div class="absolute right-4 top-4 flex space-x-2">
                <a href="https://www.tiendasmaka.com/mi-cuenta/" target="_blank" 
                   class="bg-white bg-opacity-20 w-8 h-8 rounded-full flex items-center justify-center hover:bg-opacity-30 transition">
                    <i class="fas fa-user text-sm"></i>
                </a>
                <a href="https://www.tiendasmaka.com/" target="_blank" 
                   class="bg-white text-blue-600 text-xs font-bold py-1 px-3 rounded-full flex items-center hover:bg-blue-50 transition">
                    <i class="fas fa-store mr-1"></i> Tienda
                </a>
            </div>
        </header>

        <!-- Category Chips with Animated Icons -->
        <div class="px-4 py-2 bg-white shadow-sm flex overflow-x-auto space-x-2 no-scrollbar">
            <button onclick="quickQuestion('Quiero aumentar masa muscular')" class="category-chip flex-shrink-0 bg-blue-50 text-blue-600 px-3 py-1 rounded-full text-xs font-medium flex items-center">
                <i class="fas fa-dumbbell mr-1 text-xs bounce"></i> Masa muscular
            </button>
            <button onclick="quickQuestion('Necesito bajar de peso')" class="category-chip flex-shrink-0 bg-red-50 text-red-600 px-3 py-1 rounded-full text-xs font-medium flex items-center">
                <i class="fas fa-weight mr-1 text-xs bounce"></i> Bajar peso
            </button>
            <button onclick="quickQuestion('Quiero más energía')" class="category-chip flex-shrink-0 bg-yellow-50 text-yellow-600 px-3 py-1 rounded-full text-xs font-medium flex items-center">
                <i class="fas fa-bolt mr-1 text-xs bounce"></i> Energía
            </button>
            <button onclick="quickQuestion('Mejorar digestión')" class="category-chip flex-shrink-0 bg-green-50 text-green-600 px-3 py-1 rounded-full text-xs font-medium flex items-center">
                <i class="fas fa-leaf mr-1 text-xs bounce"></i> Digestión
            </button>
        </div>

        <!-- Chat Container -->
        <div class="chat-container overflow-y-auto p-4 flex-1 space-y-4">
            <div class="bot-message flex">
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                    <i class="fas fa-smile text-blue-500"></i>
                </div>
                <div class="bg-white p-3 rounded-xl shadow-sm max-w-xs">
                    <p class="text-gray-800">¡Hola amigo! Soy tu NutriAmigo de <span class="font-bold text-blue-500">Tienda Maka</span>. Cuéntame, ¿qué objetivo quieres lograr hoy?</p>
                    <div class="mt-2 text-xs text-gray-500">
                        <p>Puedes preguntarme lo que necesites, desde cómo tomar un producto hasta crear un plan personalizado para ti.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Input Area with Friendly Suggestions -->
        <div class="bg-white p-4 border-t border-gray-200">
            <div class="flex flex-wrap gap-2 mb-2">
                <button onclick="quickQuestion('¿Cómo tomar la fibra?')" class="text-xs bg-blue-50 text-blue-600 px-3 py-1 rounded-full hover:bg-blue-100 transition flex items-center">
                    <i class="fas fa-question-circle mr-1"></i> Dudas de consumo
                </button>
                <button onclick="quickQuestion('Recomiéndame algo para...')" class="text-xs bg-blue-50 text-blue-600 px-3 py-1 rounded-full hover:bg-blue-100 transition flex items-center">
                    <i class="fas fa-lightbulb mr-1"></i> Recomendación
                </button>
                <button onclick="quickQuestion('¿Cuál es la diferencia entre...?')" class="text-xs bg-blue-50 text-blue-600 px-3 py-1 rounded-full hover:bg-blue-100 transition flex items-center">
                    <i class="fas fa-balance-scale mr-1"></i> Comparación
                </button>
            </div>
            <div class="flex items-center relative">
                <input type="text" id="userInput" placeholder="Pregúntame lo que necesites..." 
                    class="flex-1 border border-gray-300 rounded-full py-2 px-4 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button id="voiceBtn" class="absolute right-12 text-gray-400 hover:text-blue-500">
                    <i class="fas fa-microphone"></i>
                </button>
                <button id="sendBtn" class="ml-2 bg-blue-500 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-blue-600 transition">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced knowledge base with detailed guides
        const knowledgeBase = {
            "fibra": {
                response: "¡Excelente elección con la fibra! Es perfecta para mejorar tu digestión y ayudarte a sentirte más ligero. Te explico cómo sacarle el máximo provecho:",
                guide: {
                    title: "Guía de consumo de Fibra Natural Maka",
                    steps: [
                        {
                            icon: "fas fa-sun",
                            time: "Mañana",
                            instruction: "Toma 1 cucharada (10g) en ayunas con un vaso grande de agua",
                            benefit: "Activa tu sistema digestivo desde temprano"
                        },
                        {
                            icon: "fas fa-utensils",
                            time: "Almuerzo",
                            instruction: "Mezcla 1 cucharada con tu jugo o batido favorito",
                            benefit: "Ayuda a controlar el apetito en la tarde"
                        },
                        {
                            icon: "fas fa-moon",
                            time: "Noche",
                            instruction: "1 cucharada antes de dormir con infusión caliente",
                            benefit: "Promueve la limpieza intestinal durante la noche"
                        }
                    ],
                    duration: "30 días (3 tarros)",
                    results: "Notarás mejor digestión, menos hinchazón y control del apetito",
                    tip: "Aumenta gradualmente la dosis y toma mucha agua"
                },
                product: {
                    name: "Fibra Natural Plus",
                    description: "Mezcla de fibras solubles e insolubles con prebióticos",
                    price: "$59.900",
                    link: "https://www.tiendasmaka.com/producto/fibra-natural/",
                    image: "https://cdn-icons-png.flaticon.com/512/3058/3058979.png"
                },
                cta: {
                    text: "¿Quieres que programemos recordatorios para tu consumo?",
                    action: "schedule"
                }
            },
            "proteína": {
                response: "¡Las proteínas son esenciales para tus músculos! Te cuento cómo integrarlas en tu rutina según tus objetivos:",
                guide: {
                    title: "Plan de Proteína Perfecta",
                    steps: [
                        {
                            icon: "fas fa-dumbbell",
                            time: "Post-entreno",
                            instruction: "1 scoop (30g) mezclado con agua o leche vegetal",
                            benefit: "Recuperación muscular inmediata"
                        },
                        {
                            icon: "fas fa-bed",
                            time: "Antes de dormir",
                            instruction: "1/2 scoop de caseína con yogur griego",
                            benefit: "Nutrición muscular durante la noche"
                        }
                    ],
                    duration: "4-8 semanas para ver cambios notables",
                    results: "Mayor definición muscular y mejor recuperación",
                    tip: "Combínala con ejercicio regular y descanso adecuado"
                },
                product: {
                    name: "Proteína Vegana Maka",
                    description: "Completa en aminoácidos, fácil digestión y gran sabor",
                    price: "$89.900",
                    link: "https://www.tiendasmaka.com/producto/proteina-vegana/",
                    image: "https://cdn-icons-png.flaticon.com/512/3048/3048373.png"
                },
                cta: {
                    text: "¿Quieres que ajustemos las cantidades según tu peso?",
                    action: "calculate"
                }
            },
            "quemador": {
                response: "Los quemadores naturales pueden ser grandes aliados. Te explico cómo usarlos de forma segura y efectiva:",
                guide: {
                    title: "Protocolo para Quemadores",
                    steps: [
                        {
                            icon: "fas fa-mug-hot",
                            time: "Mañana",
                            instruction: "1 cápsula con el desayuno (evita después de las 2pm)",
                            benefit: "Acelera metabolismo desde temprano"
                        },
                        {
                            icon: "fas fa-walking",
                            time: "Pre-entreno",
                            instruction: "1 cápsula 30 min antes de ejercicio (solo días activos)",
                            benefit: "Maximiza quema de calorías"
                        }
                    ],
                    duration: "Ciclos de 8 semanas con descansos",
                    results: "Mejor definición y energía controlada",
                    tip: "No consumir con el estómago vacío y mantener hidratación"
                },
                product: {
                    name: "Termogénico Ultra Natural",
                    description: "Fórmula con té verde, café verde y pimienta de cayena",
                    price: "$79.900",
                    link: "https://www.tiendasmaka.com/producto/termogenico-ultra/",
                    image: "https://cdn-icons-png.flaticon.com/512/3123/3123628.png"
                },
                cta: {
                    text: "¿Quieres que te ayude a calcular tu dosis ideal?",
                    action: "calculate"
                }
            },
            "default": {
                response: "Cuéntame más sobre lo que necesitas, ¿es para algún objetivo específico? Quiero recomendarte exactamente lo que te conviene.",
                options: [
                    {
                        icon: "fas fa-heartbeat",
                        text: "Mejorar mi salud general",
                        query: "suplementos para salud general"
                    },
                    {
                        icon: "fas fa-running",
                        text: "Aumentar mi rendimiento",
                        query: "suplementos para rendimiento deportivo"
                    },
                    {
                        icon: "fas fa-balance-scale",
                        text: "Controlar mi peso",
                        query: "suplementos para control de peso"
                    },
                    {
                        icon: "fas fa-brain",
                        text: "Mejorar mi enfoque mental",
                        query: "suplementos para concentración"
                    }
                ]
            }
        };

        // DOM elements
        const chatContainer = document.querySelector('.chat-container');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const voiceBtn = document.getElementById('voiceBtn');

        // Add message to chat with friendly tone
        function addMessage(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `${isUser ? 'user-message ml-auto flex-row-reverse' : 'bot-message mb-4 flex'}`;
            
            const iconDiv = document.createElement('div');
            iconDiv.className = `w-10 h-10 ${isUser ? 'bg-blue-500' : 'bg-blue-100'} rounded-full flex items-center justify-center mr-3 flex-shrink-0`;
            
            const icon = document.createElement('i');
            icon.className = `fas ${isUser ? 'fa-user text-white' : 'fa-smile text-blue-500'}`;
            iconDiv.appendChild(icon);
            
            const textDiv = document.createElement('div');
            textDiv.className = `${isUser ? 'bg-blue-500 text-white' : 'bg-white'} p-3 rounded-xl shadow-sm max-w-xs`;
            textDiv.innerHTML = `<p>${text}</p>`;
            
            messageDiv.appendChild(iconDiv);
            messageDiv.appendChild(textDiv);
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Create consumption guide with animated icons
        function createConsumptionGuide(guide, product) {
            return `
                <div class="bg-white p-4 rounded-xl shadow-sm border border-blue-100">
                    <h3 class="font-bold text-blue-600 text-center mb-3">${guide.title}</h3>
                    
                    <div class="space-y-4 mb-4">
                        ${guide.steps.map(step => `
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                    <i class="${step.icon} text-blue-500 bounce"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-800">${step.time}: ${step.instruction}</p>
                                    <p class="text-xs text-gray-600">${step.benefit}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-3 mb-4">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-calendar-check text-blue-500 mr-2"></i>
                            <span class="text-sm font-medium">Duración recomendada:</span>
                        </div>
                        <p class="text-xs">${guide.duration}</p>
                        
                        <div class="flex items-center mt-3 mb-2">
                            <i class="fas fa-chart-line text-blue-500 mr-2"></i>
                            <span class="text-sm font-medium">Resultados esperados:</span>
                        </div>
                        <p class="text-xs">${guide.results}</p>
                        
                        <div class="flex items-center mt-3 mb-2">
                            <i class="fas fa-lightbulb text-blue-500 mr-2"></i>
                            <span class="text-sm font-medium">Tip experto:</span>
                        </div>
                        <p class="text-xs">${guide.tip}</p>
                    </div>
                    
                    <div class="border-t border-gray-200 pt-3">
                        <div class="flex items-center mb-3">
                            <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                                <img src="${product.image}" alt="${product.name}" class="w-10 h-10 object-contain">
                            </div>
                            <div>
                                <p class="font-medium text-sm">${product.name}</p>
                                <p class="text-xs text-gray-600">${product.description}</p>
                                <p class="text-sm font-bold text-blue-600 mt-1">${product.price}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Create friendly CTA with action
        function createFriendlyCTA(cta, product) {
            if (cta.action === "schedule") {
                return `
                    <div class="bg-blue-50 rounded-xl p-4 text-center mt-4">
                        <p class="text-sm mb-3">${cta.text}</p>
                        <button onclick="scheduleReminders()" class="cta-button inline-flex items-center text-white text-sm font-medium py-2 px-4 rounded-full mx-1">
                            <i class="fas fa-bell mr-2"></i> Programar
                        </button>
                        <button onclick="showProductLink('${product.link}')" class="bg-white border border-blue-500 text-blue-500 text-sm font-medium py-2 px-4 rounded-full mx-1 hover:bg-blue-50">
                            <i class="fas fa-info-circle mr-2"></i> Ver detalles
                        </button>
                    </div>
                `;
            } else if (cta.action === "calculate") {
                return `
                    <div class="bg-blue-50 rounded-xl p-4 text-center mt-4">
                        <p class="text-sm mb-3">${cta.text}</p>
                        <button onclick="calculateDosage()" class="cta-button inline-flex items-center text-white text-sm font-medium py-2 px-4 rounded-full mx-1">
                            <i class="fas fa-calculator mr-2"></i> Calcular
                        </button>
                        <button onclick="showProductLink('${product.link}')" class="bg-white border border-blue-500 text-blue-500 text-sm font-medium py-2 px-4 rounded-full mx-1 hover:bg-blue-50">
                            <i class="fas fa-info-circle mr-2"></i> Más info
                        </button>
                    </div>
                `;
            }
        }

        // Create friendly options for default response
        function createFriendlyOptions(options) {
            return `
                <div class="bg-white p-3 rounded-xl shadow-sm">
                    <p class="text-sm text-gray-700 mb-3">Puedo ayudarte con:</p>
                    <div class="grid grid-cols-2 gap-2">
                        ${options.map(option => `
                            <button onclick="quickQuestion('${option.query}')" class="text-xs bg-blue-50 text-blue-600 px-3 py-2 rounded-lg hover:bg-blue-100 transition flex items-center">
                                <i class="${option.icon} mr-2 text-sm"></i> ${option.text}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Process user input with friendly responses
        function processInput() {
            const inputText = userInput.value.trim().toLowerCase();
            if (!inputText) return;
            
            addMessage(inputText, true);
            userInput.value = '';
            
            // Simulate typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'bot-message mb-4 flex';
            typingIndicator.innerHTML = `
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                    <i class="fas fa-smile text-blue-500"></i>
                </div>
                <div class="bg-white p-3 rounded-xl shadow-sm w-24">
                    <div class="typing-indicator flex justify-center">
                        <span class="animate-bounce" style="animation-delay: 0s"></span>
                        <span class="animate-bounce" style="animation-delay: 0.2s"></span>
                        <span class="animate-bounce" style="animation-delay: 0.4s"></span>
                    </div>
                </div>
            `;
            chatContainer.appendChild(typingIndicator);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Simulate delay for "processing"
            setTimeout(() => {
                chatContainer.removeChild(typingIndicator);
                
                let response = knowledgeBase.default;
                for (const key in knowledgeBase) {
                    if (inputText.includes(key)) {
                        response = knowledgeBase[key];
                        break;
                    }
                }
                
                addMessage(response.response, false);
                
                // Create response container
                const responseDiv = document.createElement('div');
                responseDiv.className = 'bot-message mb-4 flex';
                
                const iconDiv = document.createElement('div');
                iconDiv.className = 'w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0';
                iconDiv.innerHTML = '<i class="fas fa-smile text-blue-500"></i>';
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'bg-white p-3 rounded-xl shadow-sm max-w-full w-full';
                
                if (response.guide && response.product) {
                    contentDiv.innerHTML = createConsumptionGuide(response.guide, response.product);
                    
                    if (response.cta) {
                        contentDiv.innerHTML += createFriendlyCTA(response.cta, response.product);
                    }
                } else if (response.options) {
                    contentDiv.innerHTML = createFriendlyOptions(response.options);
                }
                
                responseDiv.appendChild(iconDiv);
                responseDiv.appendChild(contentDiv);
                chatContainer.appendChild(responseDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1500);
        }

        // Quick question buttons
        function quickQuestion(question) {
            userInput.value = question;
            processInput();
        }

        // Show product link after guidance
        function showProductLink(link) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message mb-4 flex';
            messageDiv.innerHTML = `
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                    <i class="fas fa-link text-blue-500"></i>
                </div>
                <div class="bg-white p-3 rounded-xl shadow-sm max-w-xs">
                    <p class="text-sm mb-2">Aquí tienes el enlace para ver más detalles del producto:</p>
                    <a href="${link}" target="_blank" class="text-blue-500 text-sm underline">Ver en Tienda Maka</a>
                    <p class="text-xs text-gray-500 mt-2">¿Necesitas algo más? Estoy aquí para ayudarte.</p>
                </div>
            `;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Schedule reminders function
        function scheduleReminders() {
            addMessage("¡Claro que sí! Vamos a programar tus recordatorios. ¿A qué horas prefieres tomarlo?", false);
            
            // Simulate calendar integration
            setTimeout(() => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'bot-message mb-4 flex';
                messageDiv.innerHTML = `
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                        <i class="fas fa-calendar-alt text-blue-500"></i>
                    </div>
                    <div class="bg-white p-3 rounded-xl shadow-sm max-w-xs">
                        <p class="text-sm mb-3">He creado recordatorios para tu consumo. ¿Quieres agregarlos a tu calendario?</p>
                        <a href="https://calendar.google.com/calendar/u/0/r/eventedit?text=Tomar+Fibra+Natural+Maka&details=Recuerda+tomar+tu+dosis+de+fibra+para+mejorar+tu+digestión&location=En+casa" 
                           target="_blank" class="cta-button inline-flex items-center text-white text-sm font-medium py-2 px-3 rounded-full">
                            <i class="fab fa-google mr-2"></i> Agregar a Google Calendar
                        </a>
                        <p class="text-xs text-gray-500 mt-2">Después puedes ver el producto con más detalle.</p>
                    </div>
                `;
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1000);
        }

        // Calculate dosage function
        function calculateDosage() {
            addMessage("Perfecto, para calcular tu dosis ideal necesito saber tu peso actual. ¿Cuánto pesas actualmente?", false);
            
            // Simulate dosage calculation
            setTimeout(() => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'bot-message mb-4 flex';
                messageDiv.innerHTML = `
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                        <i class="fas fa-calculator text-blue-500"></i>
                    </div>
                    <div class="bg-white p-3 rounded-xl shadow-sm max-w-xs">
                        <p class="text-sm mb-2">Basado en un peso de 70kg (puedes cambiarlo):</p>
                        <p class="text-xs bg-blue-50 p-2 rounded-lg mb-3">Tu dosis ideal sería <span class="font-bold">1.5 cucharadas</span> por toma, 2 veces al día.</p>
                        <p class="text-xs text-gray-600">Recuerda que esto es una recomendación general. ¿Quieres ajustar algo?</p>
                    </div>
                `;
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1000);
        }

        // Voice input (placeholder)
        voiceBtn.addEventListener('click', () => {
            voiceBtn.innerHTML = '<i class="fas fa-circle text-red-500 pulse"></i>';
            setTimeout(() => {
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                userInput.value = "Quiero saber cómo tomar la fibra";
                processInput();
            }, 2000);
        });

        // Event listeners
        sendBtn.addEventListener('click', processInput);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') processInput();
        });

        // Initial friendly message with delay
        setTimeout(() => {
            const welcomeMessage = document.createElement('div');
            welcomeMessage.className = 'bot-message mb-4 flex';
            welcomeMessage.innerHTML = `
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                    <i class="fas fa-smile text-blue-500"></i>
                </div>
                <div class="bg-white p-3 rounded-xl shadow-sm max-w-xs">
                    <p class="text-gray-800">Estoy aquí para ayudarte a elegir los mejores suplementos y enseñarte cómo usarlos para que logres tus objetivos.</p>
                    <p class="text-xs text-gray-500 mt-2">Pregúntame lo que necesites, sin compromiso.</p>
                </div>
            `;
            chatContainer.appendChild(welcomeMessage);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }, 3000);
    </script>
</html>